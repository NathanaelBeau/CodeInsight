Convert a categorical variable to it&#39;s numerical index on column col0 on dataframe pandas df0 with astype

import pandas as pd

def test(df0, col0):

